{% extends "base.html" %}
{% load static %}
{% block title %}Home - E-Shop{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-3 d-none d-lg-block">
    <!-- Vertical category list -->
    <div class="card p-3 mb-4">
      <h6 class="mb-3">Categories</h6>
      {% for item in category_data %}
        <a class="d-block py-2 small text-decoration-none" href="{% url 'product_list' item.category.slug %}">
          {{ item.category.name }}
        </a>
      {% endfor %}
    </div>
  </div>

  <div class="col-lg-9">
    <!-- Hero / carousel -->
    <div class="mb-4 rounded" style="background:linear-gradient(90deg, #2874f0, #1a61d6); color:#fff; padding:28px;">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2 class="mb-1">Welcome to E-Shop</h2>
          <div class="small">Best deals and offers — Flipkart style layout</div>
        </div>
        <img src="{% static 'images/hero-placeholder.png' %}" alt="hero" style="max-height:80px;">
      </div>
    </div>

    <!-- category sections -->
    {% for item in category_data %}
      {% if item.products %}
      <section class="mb-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">{{ item.category.name }}</h5>
          <a href="{% url 'product_list' item.category.slug %}" class="small-muted small">View all</a>
        </div>

        <div class="row g-3">
          {% for product in item.products %}
          <div class="col-md-3 col-sm-6">
            <div class="product-card text-center">
              {% if product.thumbnail %}
                <img src="{{ product.thumbnail.url }}" class="img-fluid mb-2" style="height:140px;object-fit:contain;">
              {% else %}
                <img src="https://via.placeholder.com/200x150" class="img-fluid mb-2">
              {% endif %}

              <h6 class="mb-1" style="font-size:0.95rem;">
                {{ product.name|truncatechars:40 }}
              </h6>

              {% if product.discount_price %}
                <div>
                  <span class="price">₹{{ product.discount_price }}</span>
                  <small class="strike ms-2">₹{{ product.price }}</small>
                </div>
              {% else %}
                <div class="price">₹{{ product.price }}</div>
              {% endif %}

              <div class="mt-2">
                <a href="{% url 'product_detail' product.slug %}" class="btn btn-sm btn-outline-primary me-1">View</a>
                <a href="{% url 'add_to_cart' product.id %}" class="btn btn-sm btn-primary">Add</a>
              </div>

            </div>
          </div>
          {% endfor %}
        </div>
      </section>
      {% endif %}
    {% endfor %}
  </div>
</div>
{% endblock %}
